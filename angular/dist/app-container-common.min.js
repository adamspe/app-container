/*
 * app-container-common
 * Version: 1.0.0 - 2017-06-26
 */
angular.module("app-container-common.directives",[]).directive("spinner",["$log",function(a){return{restrict:"AEC",template:'<md-progress-circular ng-if="working()" md-mode="indeterminate" class="{{class}}"></md-progress-circular>',scope:{working:"&isWorking"},link:function(b,c,d){a.warn("spinner directive is deprecated, use md-progress-circular directly"),b.class=d.class||"md-accent"}}}]),angular.module("app-container-common.filters",[]),angular.module("app-container-common",["app-container-common.providers","templates-app-container-common","app-container-common.filters","app-container-common.services","app-container-common.directives","app-container-common.panes"]).config(["$logProvider",function(a){a.debugEnabled(window.location.hash&&window.location.hash.match(/^#.*#debug/))}]),angular.module("app-container-common.panes",[]).service("PaneStateService",[function(){var a={},b={getState:function(b,c){return a[c]||(a[c]={paneId:c,setId:b,active:!1}),a[c]},getStates:function(b){return Object.keys(a).reduce(function(c,d){return a[d].setId===b&&c.push(a[d]),c},[])},activate:function(c){a[c]&&b.getStates(a[c].setId).forEach(function(a){a.active=a.paneId===c})},deactivate:function(a){b.getStates(a).forEach(function(a){a.active=!1})},isActive:function(b){return a[b]&&a[b].active},anyActive:function(a){return b.getStates(a).reduce(function(a,b){return a||b.active},!1)},updatePaneId:function(b,c){if(b!==c&&a[c])return console.log("preUpdate",a,b,c),a[b]=a[c],a[b].paneId=b,delete a[c],console.log("postUpdate",a),a[b]}};return b}]).controller("PaneSetController",["$scope","PaneStateService",function(a,b){if(!a.uniqueId)throw"pane-set requires a unique-id.";var c=this,d=a.uniqueId;c.panes=[],c.anyActive=function(){return b.anyActive(d)},c.closeContents=function(){b.deactivate(d)},c.addPane=function(a){var e={pane:a};e.pane.state=b.getState(d,e.pane.uniqueId),c.panes.push(e)},c.updatePaneId=function(a,c,d){b.updatePaneId(c,d)},c.removePane=function(a){},c.select=function(a,d,e){e?c.anyActive()||b.activate(a.uniqueId):b.activate(a.uniqueId)}}]).directive("paneSet",[function(){return{transclude:{header:"?paneSetHeader",footer:"?paneSetFooter"},replace:!0,scope:{uniqueId:"@"},controller:"PaneSetController",controllerAs:"paneset",templateUrl:"js/panes/paneset.html",link:function(a,b,c){var d=parseInt(c.openHeadingCols||"6");a.$watch("paneset.anyActive()",function(b){b?(a.openLeftCols="col-xs-0 col-sm-"+d,a.openRightCols="col-xs-12 col-sm-"+(12-d)):(a.openLeftCols="col-xs-12",a.openRightCols="col-xs-0")})}}}]).directive("pane",["$parse",function(a){return{restrict:"E",require:"^paneSet",transclude:!0,replace:!0,templateUrl:"js/panes/pane.html",scope:{uniqueId:"@",open:"@paneOpen"},controller:[function(){}],controllerAs:"pane",link:function(a,b,c,d,e){if(!a.uniqueId)throw"pane requires a unique-id.";d.addPane(a),a.$watch("uniqueId",function(b,c){d.updatePaneId(a,b,c)}),a.selectability="selectable","undefined"==typeof c.headingOnly?a.select=function(b){d.select(a,b)}:a.selectability="not-selectable",a.$on("$destroy",function(){d.removePane(a)}),a.$transcludeFn=e,a.$watch("open",function(b){"true"===b&&d.select(a,{},!0)})}}}]).directive("paneHeadingTransclude",[function(){return{restrict:"A",require:"^pane",link:function(a,b){a.$watch("headingElement",function(a){a&&(b.html(""),b.append(a))})}}}]).directive("paneContentTransclude",["$animate","$compile",function(a,b){function c(a){return a.tagName&&("pane-heading"===a.tagName.toLowerCase()||"pane-title"===a.tagName.toLowerCase())}function d(a){var b;if(a.tagName&&a.childNodes&&a.childNodes.length)for(b=0;b<a.childNodes.length;b++)if(c(a.childNodes[b]))return a.childNodes[b]}return{restrict:"A",require:"^paneSet",transclude:!0,link:function(a,b,e,f,g){var h=a.pane=a.$eval(e.paneContentTransclude).pane;h.$transcludeFn(h.$parent,function(a){angular.forEach(a,function(a,e){var f;!h.headingElement&&c(a)?h.headingElement=a:(!h.headingElement&&(f=d(a))&&(h.headingElement=f),b.append(a))})})}}}]).directive("paneTitle",[function(){return{restrict:"E",template:'<div class="pane-title"><label>{{title}}</label></div>',scope:{title:"@"},link:function(a){}}}]).directive("paneSetTitle",[function(){return{restrict:"C",template:"<h3>{{$paneSetTitle}}</h3>",link:function(a,b,c){c.$observe("title",function(b){a.$paneSetTitle=b})}}}]).directive("staticPaneSet",[function(){return{restrict:"E",templateUrl:"js/panes/static-pane-set.html",transclude:{header:"?paneSetHeader",footer:"?paneSetFooter",left:"?paneSetLeft",right:"?paneSetRight"},link:function(a,b,c){var d=parseInt(c.openHeadingCols||"6");a.$openLeftCols="col-xs-"+d,a.$openRightCols="col-xs-"+(12-d)}}}]),angular.module("templates-app-container-common",["js/panes/pane.html","js/panes/paneset.html","js/panes/static-pane-set.html"]),angular.module("js/panes/pane.html",[]).run(["$templateCache",function(a){a.put("js/panes/pane.html",'<li class="pane-heading" ng-class="[{active: state.active},selectability]" ng-click="select($event)" pane-heading-transclude></li>\n')}]),angular.module("js/panes/paneset.html",[]).run(["$templateCache",function(a){a.put("js/panes/paneset.html",'<div class="container-fluid panes">\n    <div class="row">\n        <div class="pane headings" ng-class="[openLeftCols]">\n            <div class="pane-contents">\n                <div class="pane-set-header" ng-transclude="header"></div>\n                <ul class="inner list-unstyled" ng-transclude></ul>\n                <div class="pane-set-footer" ng-transclude="footer"></div>\n            </div>\n        </div>\n        <div class="pane contents closeable" ng-class="[openRightCols]">\n            <a href class="contents-close" ng-click="paneset.closeContents()"></a>\n            <div class="pane-contents">\n                <div class="inner" ng-repeat="pane in paneset.panes" ng-show="pane.state.active" pane-content-transclude="pane"></div>\n            </div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("js/panes/static-pane-set.html",[]).run(["$templateCache",function(a){a.put("js/panes/static-pane-set.html",'<div class="container-fluid panes static">\n    <div class="row">\n        <div class="pane headings" ng-class="[$openLeftCols]">\n            <div class="pane-contents">\n                <div class="pane-set-header" ng-transclude="header"></div>\n                <div class="inner" ng-transclude="left"></div>\n                <div class="pane-set-footer" ng-transclude="footer"></div>\n            </div>\n        </div>\n        <div class="pane contents" ng-class="[$openRightCols]">\n            <div class="pane-contents">\n                <div class="inner" ng-transclude="right"></div>\n            </div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("app-container-common.providers",["ngResource"]).provider("$typeAheadFinder",[function(){this.$get=["$q","$timeout","$log",function(a,b,c){return function(d,e,f){e=e||function(a){return"contains(text,'"+a+"')"},f=f||angular.identity;var g;return function(h){g&&b.cancel(g);var i=a.defer();return g=b(function(){c.debug("typeaheadFinder",h);var a=e(h),b="string"==typeof a?{$filter:a}:a;d.query(b,function(a){i.resolve(a.list.filter(f))}),i.promise.then(function(a){return a})},500),i.promise}}}]}]).provider("$apiConfig",[function(){this.apiRoot="/api/v1/",this.$get=[function(){return{apiRoot:this.apiRoot}}]}]).provider("$appService",[function(){this.$get=["$log","$resource","$http","$q","$sce","$apiConfig",function(a,b,c,d,e,f){a.debug("$apiConfig",f);var g=f.apiRoot;return function(a,f,h){function i(a,b){return l.$$htmlAtts.forEach(function(b){delete a["$"+b]}),Object.keys(a).forEach(function(b){/^_/.test(b)&&angular.isObject(a[b])&&a[b]._id&&(a[b]=a[b]._id)}),angular.toJson(a)}var j=function(a,b){var c=angular.fromJson(a);return new l(c)},k=b(g+a,{},{get:{method:"GET",transformResponse:j},query:{method:"GET",isArray:!1,transformResponse:function(a,b){var c=angular.fromJson(a);return c&&c.list&&c.list.length&&(c.list=c.list.map(function(a){return new l(a)})),c}},update:{method:"PUT",transformRequest:i,transformResponse:j},save:{method:"POST",transformRequest:i,transformResponse:j}}),l=function(){k.apply(this,arguments),l.$$each(this)};return Object.getOwnPropertyNames(k).forEach(function(a){["caller","arguments"].indexOf(a)===-1&&(l[a]=k[a])}),l.$$htmlAtts=f||[],l.$$custom_each=h||angular.identity,l.$$each=function(a){return a=l.$$custom_each(a),l.$$htmlAtts.forEach(function(b){a[b]&&(a["$"+b]=e.trustAsHtml(a[b]))}),a},l.prototype.chaseLink=function(a,b,e){var f=d.defer(),g=this._links[a];return e=e||{},c.get(g,e).then(function(a){var c=a.data;c&&c.list?(c.list=c.list.map(function(a){return new b(a)}),f.resolve(c)):f.reject()}),f.promise},l.$basePath=function(a){return a.substring(0,a.lastIndexOf("/"))}(g+a),l}}]}]),angular.module("app-container-common.services",["app-container-common.providers"]).factory("DialogService",["$q","$log","$mdDialog",function(a,b,c){var d={confirm:function(d){b.warn("DialogService deprecated: use $mdDialog directly.");var e=a.defer(),f=c.confirm().title(d.question).textContent(d.warning).ariaLabel(d.ariaLabel).ok(d.yesText||"Yes").cancel(d.noText||"No");return c.show(f).then(e.resolve,e.reject),e.promise}};return d}]).factory("NotificationService",["$log","$timeout","$sce","$mdToast",function(a,b,c,d){var e={addError:function(a){var b="string"==typeof a?a:a&&a.statusText?a.statusText:"";return a&&a.data&&a.data.message&&(b+=" : "+a.data.message),d.show(d.simple().textContent(b).position("bottom").action("OK").highlightAction(!0).highlightClass("md-warn").hideDelay(0))},addInfo:function(a){return d.show(d.simple().textContent(a).position("bottom"))},hideToast:d.hide,cancelToast:d.cancel};return e}]).factory("WebSocketConnection",["$log","$window","$apiConfig",function(a,b,c){function d(d,f){this.$wsUrl="ws://"+b.location.host+("/"===d.charAt(0)?d:c.apiRoot+d),a.debug("WebSocketConnection.wsUrl",this.$wsUrl),this.$cx=new e(this.$wsUrl),"function"==typeof f&&(this.$cx.onopen=f)}var e=b.WebSocket||b.MozWebSocket;return d.prototype.url=function(){return this.$wsUrl},d.prototype.connection=function(){return this.$cx},d.prototype.onMessage=function(b){var c=this;c.connection().onmessage=function(c){a.debug("WebSocketConnection.message",c);var d=c.data;"string"==typeof d&&"{"===d.charAt(0)&&(d=JSON.parse(d)),b(d,c)}},d.prototype.send=function(b){"object"==typeof b&&(b=JSON.stringify(b)),a.debug("WebSocketConnection.send",b),this.connection().send(b)},d.prototype.connectionCloser=function(){var a=this;return function(){a.connection().close()}},d}]);